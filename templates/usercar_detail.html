{% load static %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{{ car.model }} — AutoWave</title>
    <link rel="stylesheet" href="{% static 'css/car_details.css' %}">
</head>
<body>
    <!-- Topbar -->
    <header class="topbar">
        <div class="container topbar-inner">
            <div class="logo">AutoWave</div>
            <nav class="main-nav">
                <a href="{% url 'home' %}#home">Home</a>
                <a href="{% url 'home' %}#about">About</a>
            </nav>
            <div class="auth">
                <a href="{% url 'home' %}" class="btn ghost">Logout</a>
              
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="details container">
        <div class="details-grid glass">
            <div class="image-col">
                {% if car.photo %}
                    <img src="{{ car.photo.url }}" alt="{{ car.model }}">
                {% else %}
                    <div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#111;color:#ddd">
                        No image
                    </div>
                {% endif %}
            </div>

            <div class="info-col">
                <h1>{{ car.model }}</h1>
                <p>{{ car.description }}</p>
                <p class="price">{{ car.price_display }}</p>

                <p style="margin-top:1rem; color:var(--muted);">
                    You must login or create an account to book this car.
                </p>
                <div class="detail-actions">
                    <!-- Show only appropriate action based on car type -->
                    {% if car.car_type == 'rent' %}
                        <button class="btn primary rent-btn" data-id="{{ car.id }}" style="margin-left:.5rem">Rent</button>
                    {% elif car.car_type == 'sale' %}
                        <button class="btn primary buy-btn" data-id="{{ car.id }}" style="margin-left:.5rem">Buy</button>
                    {% else %}
                        <button class="btn primary rent-btn" data-id="{{ car.id }}" style="margin-left:.5rem">Rent</button>
                        <button class="btn primary buy-btn" data-id="{{ car.id }}" style="margin-left:.5rem">Buy</button>
                    {% endif %}
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">© AutoWave — Smooth rides, clear deals.</div>
    </footer>

    <!-- Login Modal -->
    <div id="loginOverlay" class="modal-overlay hidden">
        <div class="modal" id="loginModal">
            <button class="modal-close" id="loginClose">&times;</button>
            <div class="modal-content">
                <form id="loginFormIndex" class="auth-form" method="post" action="{% url 'login' %}">
                    {% csrf_token %}
                    <h3 style="color:#e6eef8">Member Login</h3>
                    <label>Email</label>
                    <input type="email" name="email" placeholder="you@example.com" required>
                    <label>Password</label>
                    <input type="password" name="password" placeholder="Your password" required>
                    <button class="btn primary" type="submit">Login</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Signup Modal -->
    <div id="signupOverlay" class="modal-overlay hidden">
        <div class="modal" id="signupModal">
            <button class="modal-close" id="signupClose">&times;</button>
            <div class="modal-content">
                <form id="signupFormIndex" class="auth-form" method="post" action="{% url 'signup' %}">
                    {% csrf_token %}
                    <h3 style="color:#e6eef8">Create Account</h3>
                    <label>Full Name</label>
                    <input type="text" name="name" placeholder="Your name" required>
                    <label>Email</label>
                    <input type="email" name="email" placeholder="you@example.com" required>
                    <label>Password</label>
                    <input type="password" name="password" placeholder="Choose a password" required>
                    <button class="btn primary" type="submit">Sign Up</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Booking Modal (same pattern as user.html) -->
    <div id="bookingOverlay" class="modal-overlay hidden">
        <div class="modal" id="bookingModal">
            <button class="modal-close" id="bookingClose">&times;</button>
            <div class="modal-content">
                <form id="bookingForm" class="auth-form" method="post" action="{% url 'book' %}" enctype="multipart/form-data">
                    {% csrf_token %}
                    <h3 style="color:#e6eef8">Book this Car</h3>
                    <input type="hidden" name="car_id" value="{{ car.id }}">
                    <input type="hidden" name="request_type" value="rent">
                    <label>Full Name</label>
                    <input type="text" name="full_name" required>
                    <label>Mobile Number</label>
                    <input type="text" name="mobile" required>
                    <label class="rent-only">Location</label>
                    <input class="rent-only" type="text" name="location">
                    <label class="rent-only">NID / Passport Number</label>
                    <input class="rent-only" type="text" name="id_number">
                    <label class="rent-only">Driving License Number</label>
                    <input class="rent-only" type="text" name="driving_license_number">
                    <label class="rent-only">Driving License Photo</label>
                    <input class="rent-only" type="file" name="driving_license_photo" accept="image/*">
                    <label>Your Photo</label>
                    <input type="file" name="client_photo" accept="image/*">
                    <div style="margin-top:1rem;display:flex;gap:.5rem;justify-content:flex-end;">
                        <button type="button" class="btn ghost" id="bookingCancel">Cancel</button>
                        <button type="submit" class="btn primary">Submit Booking</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- JS -->
    <script src="{% static 'js/home.js' %}"></script>
    <script>
        // Make secondary buttons open the same modal
        const loginBtn2 = document.getElementById('loginBtn2');
        const signupBtn2 = document.getElementById('signupBtn2');

        loginBtn2.addEventListener('click', () => document.getElementById('loginOverlay').classList.remove('hidden'));
        signupBtn2.addEventListener('click', () => document.getElementById('signupOverlay').classList.remove('hidden'));
    </script>
</body>
</html>