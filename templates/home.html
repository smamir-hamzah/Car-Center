{% load static %}
{% load socialaccount %}

<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>AutoWave — Rent & Buy</title>

    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" href="{% static 'css/responsive.css' %}">
    <script src="https://unpkg.com/htmx.org@1.10.0"></script>
    <script src="{% static 'js/htmx-config.js' %}"></script>
</head>

<body hx-get="." hx-trigger="every 30s" hx-swap="outerHTML">
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay {% if is_htmx %}hidden{% endif %}">
        <div class="spinner"></div>
        <div class="loading-text" style="margin-top: 1rem; margin-left: 1rem;">Loading...</div>
    </div>

    <header class="topbar">
        <div class="container topbar-inner" style="display:flex;align-items:center;justify-content:space-between;">
            <div class="logo" style="font-weight:700;font-size:1.25rem;color:#10b981">AutoWave</div>

            <!-- Hamburger (visible on small screens) -->
            <button class="hamburger" id="hamburgerBtn" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <nav class="main-nav" id="mainNav">
                <a href="#home">Home</a>
                <a href="#about">About Us</a>
                <a href="#contact">Contact Us</a>
                <a href="#location">Location</a>
                <a href="#cars">Cars</a>
                <a href="#process">How It Works</a>
                <a href="#reviews">Reviews</a>


            </nav>

            <div class="auth">
                <a href="{% url 'login' %}" class="btn ghost">Login</a>
                <a href="{% url 'signup' %}" class="btn primary">Sign Up</a>
            </div>
        </div>
    </header>

    <main id="home">
        <section class="hero-banner">
            <div class="hero-content">
                <h1>About AutoWave</h1>
                <p>
                    AutoWave offers premium cars for rent and sale with flexible plans,
                    transparent pricing, and modern features. Drive with confidence.
                </p>
                <!-- <button class="btn primary">Learn More</button> -->
            </div>
        </section>

        <section id="cars" class="cars container">
            <!-- Filter Section -->
            <div class="filter-section reveal" data-direction="left">
                <div class="filter-grid">
                    <div class="filter-group">
                        <label>Search Model</label>
                        <input type="text" id="modelSearch" class="filter-input" placeholder="e.g. Toyota, BMW...">
                    </div>
                    <div class="filter-group">
                        <label>Max Price</label>
                        <input type="number" id="priceMax" class="filter-input" placeholder="Any price">
                    </div>
                    <div class="filter-group">
                        <label>Sort By</label>
                        <select id="sortBy" class="filter-input">
                            <option value="newest">Newest First</option>
                            <option value="price_asc">Price: Low to High</option>
                            <option value="price_desc">Price: High to Low</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <button id="applyFilter" class="filter-btn">Apply Filters</button>
                    </div>
                </div>
            </div>

            <h2>Available for Rent</h2>
            <div class="grid" id="rentCars"
                style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:1rem;">
                {% for car in rentCars %}
                <div class="card glass reveal car-item" data-direction="left" data-id="{{ car.id }}"
                    data-model="{{ car.model|lower }}" data-price="{{ car.price }}"
                    style="border-radius:20px;overflow:hidden;border:1px solid #e2e8f0;box-shadow:0 4px 12px rgba(0,0,0,0.06);transition:all 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-8px)';this.style.boxShadow='0 12px 24px rgba(0,0,0,0.1)'"
                    onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 4px 12px rgba(0,0,0,0.06)'">
                    <div class="card-media" style="height:200px;overflow:hidden;position:relative;">
                        {% if car.photo %}
                        <img class="card-main" src="{{ car.photo.url }}" alt="{{ car.model }}"
                            style="width:100%;height:100%;object-fit:cover;transition:transform 0.3s ease;"
                            onmouseover="this.style.transform='scale(1.05)'"
                            onmouseout="this.style.transform='scale(1)'">
                        <div
                            style="position:absolute;top:0.75rem;right:0.75rem;background:linear-gradient(135deg,#10b981,#059669);color:white;padding:0.4rem 0.9rem;border-radius:50px;font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;box-shadow:0 2px 8px rgba(16,185,129,0.4);">
                            Rent</div>
                        {% else %}
                        <div
                            style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#f1f5f9;color:#94a3b8">
                            No image</div>
                        {% endif %}
                    </div>
                    <div class="card-body" style="padding:1.5rem">
                        <h3 style="color:#1e293b;margin:0 0 0.5rem 0;font-size:1.2rem;font-weight:700;">{{ car.model }}
                        </h3>
                        <p class="price" style="color:#10b981;font-size:1.5rem;font-weight:800;margin:0 0 1.25rem 0;">{{ car.price_display }}</p>

                        <div style="display:flex;gap:0.5rem;">
                            <a class="btn ghost" href="{% url 'car_detail' car.id %}"
                                style="flex:1;text-align:center;">Details</a>
                            <button class="btn primary rent-btn" data-id="{{ car.id }}" style="flex:1;">Rent</button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <h2 style="margin-top:2.25rem;">Cars for Sale</h2>
            <div class="grid" id="saleCars"
                style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:1rem;">
                {% for car in saleCars %}
                <div class="card glass reveal car-item" data-direction="right" data-id="{{ car.id }}"
                    data-model="{{ car.model|lower }}" data-price="{{ car.price }}"
                    style="border-radius:20px;overflow:hidden;border:1px solid #e2e8f0;box-shadow:0 4px 12px rgba(0,0,0,0.06);transition:all 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-8px)';this.style.boxShadow='0 12px 24px rgba(0,0,0,0.1)'"
                    onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 4px 12px rgba(0,0,0,0.06)'">
                    <div class="card-media" style="height:200px;overflow:hidden;position:relative;">
                        {% if car.photo %}
                        <img class="card-main" src="{{ car.photo.url }}" alt="{{ car.model }}"
                            style="width:100%;height:100%;object-fit:cover;transition:transform 0.3s ease;"
                            onmouseover="this.style.transform='scale(1.05)'"
                            onmouseout="this.style.transform='scale(1)'">
                        <div
                            style="position:absolute;top:0.75rem;right:0.75rem;background:linear-gradient(135deg,#3b82f6,#2563eb);color:white;padding:0.4rem 0.9rem;border-radius:50px;font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;box-shadow:0 2px 8px rgba(59,130,246,0.4);">
                            Sale</div>
                        {% else %}
                        <div
                            style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#f1f5f9;color:#94a3b8">
                            No image</div>
                        {% endif %}
                    </div>
                    <div class="card-body" style="padding:1.5rem">
                        <h3 style="color:#1e293b;margin:0 0 0.5rem 0;font-size:1.2rem;font-weight:700;">{{ car.model }}
                        </h3>
                        <p class="price" style="color:#10b981;font-size:1.5rem;font-weight:800;margin:0 0 1.25rem 0;">{{ car.price_display }}</p>

                        <div style="display:flex;gap:0.5rem;">
                            <a class="btn ghost" href="{% url 'car_detail' car.id %}"
                                style="flex:1;text-align:center;">Details</a>
                            <button class="btn primary buy-btn" data-id="{{ car.id }}" style="flex:1;">Buy</button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>


        <section id="location" class="map-section glass container reveal" data-direction="right">
            <h2>Our Office Location</h2>
            <div class="map-wrap" style="height:320px;overflow:hidden">
                <iframe src="https://www.google.com/maps?q=37.7749,-122.4194&z=15&output=embed"
                    style="border:0;width:100%;height:100%;" allowfullscreen="" loading="lazy"></iframe>
            </div>
            <p style="margin-top:.6rem;color:var(--muted);font-size:.95rem">
                <a href="https://maps.app.goo.gl/8KDWcveHf6M1BXHp9" target="_blank" rel="noopener"
                    style="color:var(--accent);text-decoration:none">Open in Google Maps</a>
            </p>
        </section>

        <section id="process" class="container glass reveal" data-direction="right">
            <h2>How Our Service Works</h2>
            <div class="process-steps"
                style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem;margin-top:1rem">
                <div class="step glass">
                    <h3>1. Login / Create Account</h3>
                    <p>Use your email to login or register.</p>
                </div>
                <div class="step glass">
                    <h3>2. Choose Your Car</h3>
                    <p>Select rent or buy from our modern fleet.</p>
                </div>
                <div class="step glass">
                    <h3>3. Submit the Form</h3>
                    <p>Fill your booking or purchase information.</p>
                </div>
                <div class="step glass">
                    <h3>4. Get Confirmation</h3>
                    <p>A confirmation will appear shortly in your account.</p>
                </div>
                <div class="step glass">
                    <h3>5. Visit Our Location</h3>
                    <p>Come to our office and pick up / inspect the car.</p>
                </div>
            </div>
        </section>

        <section id="reviews" class="container glass reveal" data-direction="left">
            <h2>What Our Customers Say</h2>
            <div class="reviews-grid"
                style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem;margin-top:1.5rem;">
                {% if reviews %}
                {% for r in reviews %}
                <div class="review-card glass">
                    <div class="review-header">
                        <div class="review-user-info">
                            <p class="review-user-name">
                                {% if r.user %}
                                {{ r.user.get_full_name|default:r.user.username }}
                                {% else %}
                                Anonymous
                                {% endif %}
                            </p>
                            {% if r.created_at %}
                            <p class="review-date">{{ r.created_at|date:"M d, Y" }}</p>
                            {% endif %}
                        </div>
                        <div class="review-rating">
                            {% if r.rating %}
                            {% for i in "x"|rjust:r.rating %}★{% endfor %}
                            {% else %}
                            ★★★★★
                            {% endif %}
                        </div>
                    </div>
                    <p class="review-text">{{ r.text }}</p>
                </div>
                {% endfor %}
                {% else %}
                <div class="review-empty"
                    style="grid-column: 1 / -1; text-align: center; color: rgba(230, 238, 248, 0.5); padding: 2rem;">
                    <p>No reviews yet. Be the first to share your experience!</p>
                </div>
                {% endif %}
            </div>
        </section>

        <section id="about" class="container about glass reveal" data-direction="right">
            <h2>About Us</h2>
            <p>
                AutoWave blends premium vehicles, flexible rentals and transparent buying. We curate a modern fleet —
                from efficient city cars and sporty coupes to family vans and electric models — all inspected and
                maintained to high standards.
            </p>
            <p>
                Our mission is simple: make mobility effortless. Rent by the day, week, or month with transparent
                pricing and comprehensive support, or buy with confidence through our certified pre-owned checks and
                financing guidance. We offer airport pickup, long-term corporate leasing, and dedicated customer care.
            </p>
        </section>

        <section id="contact" class="container contact glass reveal" data-direction="left">
            <h2>Contact Us</h2>
            <p> <b> If You Have Any Questions, Please Contact Us </b> </p>
            <p> <b> Acess our cotact page please login or signup first </b> </p>
            <!-- <a href="{% url 'login' %}" class="btn primary">Login</a>
            <a href="{% url 'signup' %}" class="btn primary">Signup</a> -->
        </section>

    </main>

    <footer class="footer">
        <div class="container">© AutoWave — Smooth rides, clear deals.</div>
    </footer>

    <!-- Login Modal (separate overlay) -->
    <div id="loginOverlay" class="modal-overlay hidden">
        <div class="modal" id="loginModal">
            <button class="modal-close" id="loginClose">&times;</button>
            <div class="modal-content">

                <form id="loginFormIndex" class="auth-form" method="post" action="{% url 'login' %}">
                    {% csrf_token %}
                    <h3 style="color:#1e293b">Member Login</h3>

                    <label>Username</label>
                    <input type="username" id="loginEmail" name="username" required>

                    <label>Password</label>
                    <input type="password" id="loginPass" name="password" placeholder="Your password" required>

                    <button class="btn primary" type="submit">Login</button>
                </form>

                <!-- Social login section -->
                <div class="text-center mb-3" style="margin-top: 15px;">
                    <span class="text-muted">Or sign in with</span>
                </div>

                <div class="social-card-container">
                    <form method="post" action="/accounts/google/login/" style="display:inline;margin:0;">
                        {% csrf_token %}
                        <button type="submit" class="social-card google" aria-label="Sign in with Google"
                            style="border:none;background:transparent;padding:0;">
                            <img src="{% static 'icons/google.svg' %}" alt="Google">
                            <span></span>
                        </button>
                    </form>
                    <form method="post" action="/accounts/github/login/" style="display:inline;margin:0;">
                        {% csrf_token %}
                        <button type="submit" class="social-card github" aria-label="Sign in with GitHub"
                            style="border:none;background:transparent;padding:0;">
                            <img src="{% static 'icons/github.svg' %}" alt="GitHub">
                            <span></span>
                        </button>
                    </form>
                </div>

            </div>
        </div>
    </div>


    <!-- Sign Up Modal -->
    <div id="signupOverlay" class="modal-overlay hidden">
        <div class="modal" id="signupModal">
            <button class="modal-close" id="signupClose">&times;</button>

            <div class="modal-content">
                <form id="signupFormIndex" class="auth-form" method="post" action="{% url 'signup' %}"
                    enctype="multipart/form-data">
                    {% csrf_token %}
                    <h3 style="color:#1e293b">Create Account</h3>

                    <!-- Full Name -->
                    <label>Full Name</label>
                    <input type="text" id="signupName" name="name" placeholder="Your name" required>

                    <!-- Username -->
                    <label>Username</label>
                    <input type="text" id="signupUsername" name="username" placeholder="Choose a username" required>

                    <!-- Email -->
                    <label>Email</label>
                    <input type="email" id="signupEmail" name="email" placeholder="you@example.com" required>

                    <!-- Password -->
                    <label>Password</label>
                    <input type="password" id="signupPass" name="password" placeholder="Choose a password" required>

                    <!-- Confirm Password -->
                    <label>Confirm Password</label>
                    <input type="password" id="signupConfirmPass" name="confirm_password"
                        placeholder="Confirm your password" required>

                    <!-- Profile Image -->
                    <label>Profile Image</label>
                    <input type="file" id="signupImage" name="image" accept="image/*">

                    <button class="btn primary" type="submit" style="margin-top:10px;">Sign Up</button>

                    <!-- Already have account -->
                    <div class="text-center" style="margin-top: 10px;">
                        <small>Already have an account?
                            <a href="{% url 'login' %}">Login</a>
                        </small>
                    </div>

                </form>

                <!-- Social Login Divider -->
                <div class="text-center mb-3" style="margin-top: 20px;">
                    <span class="text-muted">Or sign in with</span>
                </div>

                <!-- Social Login Buttons -->
                <div class="social-card-container">

                    <form method="post" action="/accounts/google/login/" style="display:inline;margin:0;">
                        {% csrf_token %}
                        <button type="submit" class="social-card google" aria-label="Sign up with Google"
                            style="border:none;background:transparent;padding:0;">
                            <img src="{% static 'icons/google.svg' %}" alt="Google">
                            <span>Google</span>
                        </button>
                    </form>

                    <form method="post" action="/accounts/github/login/" style="display:inline;margin:0;">
                        {% csrf_token %}
                        <button type="submit" class="social-card github" aria-label="Sign up with GitHub"
                            style="border:none;background:transparent;padding:0;">
                            <img src="{% static 'icons/github.svg' %}" alt="GitHub">
                            <span>GitHub</span>
                        </button>
                    </form>

                </div>
            </div>
        </div>
    </div>


    <script src="{% static 'js/htmx-config.js' %}"></script>
    <script src="{% static 'js/home.js' %}"></script>
    <script>
        window.addEventListener('load', function () {
            const loader = document.getElementById('loadingOverlay');
            if (loader) {
                loader.classList.add('hidden');
            }
        });
    </script>
</body>

</html>